<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>ç’ƒçš„å°çŒ«é¢æ¿ Â· ALL-IN v1.2</title>
<style>
body{margin:0;padding:24px;font-family:sans-serif;background:#111;color:#feeaff}
h1,h2{margin:0 0 14px}button{margin:6px;padding:8px 16px;border:none;border-radius:6px;background:#7a1f75;color:#fff;cursor:pointer}
button:hover{background:#b042a9}.bar-bg{width:100%;height:14px;background:#333;border-radius:7px;margin:4px 0}
.bar-fill{height:14px;width:0%;background:#66c;border-radius:7px;transition:width .3s}
.mask{position:fixed;inset:0;background:rgba(0,0,0,.85);display:flex;justify-content:center;align-items:center;text-align:center}
.win{background:#272727;padding:22px 34px;border-radius:10px;width:260px}
#countdown{font-size:28px;margin:.6rem 0}#punishTimer{font-size:34px;margin:0}
#badgeArea img{width:48px;margin:0 4px}#log{max-height:220px;overflow-y:auto;border-top:1px solid #444;margin-top:12px;font-size:14px}
#liquid{position:fixed;left:0;right:0;bottom:0;height:40px;background:#ffbce6;transition:height .6s}
.rain::before{content:'';position:fixed;inset:0;
  background:url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%23ffc9f3'><circle cx='8' cy='8' r='2'/></svg>") repeat;background-size:16px;
  animation:rain .6s linear infinite;opacity:.25;pointer-events:none}
@keyframes rain{to{background-position:0 16px}}
/* éšæœºäº‹ä»¶æ¨ªå¹… */
#randEvt{position:fixed;top:12px;left:50%;transform:translateX(-50%);
  background:#ff5aa1;color:#fff;padding:6px 16px;border-radius:8px;font-weight:bold;
  box-shadow:0 0 8px rgba(0,0,0,.4);z-index:1000;display:none;cursor:pointer}
</style>
</head>
<body>

<div id="gate">
  <h2>ğŸ–¤ è·ªå¥½ï¼Œå‘ä¸»äººæŠ¥åˆ°ã€‚</h2>
  <input id="code" placeholder="è¾“å…¥ï¼šç’ƒï¼Œæˆ‘å·²å°±ç»ª">
  <button onclick="checkCode()">æäº¤</button>
</div>

<div id="panel" style="display:none;">
  <h1>ç’ƒçš„å°çŒ«é¢æ¿ Â· ALL-IN</h1>

  <img id="catImg" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWCAYAAAA8AXHiAAAAJ0lEQVR4nO3BMQEAAADCoPdPbQ8HFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAECvA6sAAdTy0VMAAAAASUVORK5CYII=" width="140" style="display:block;margin:10px 0"/>

  <div>æœä»åº¦ <div class="bar-bg"><div id="obeyBar"  class="bar-fill"></div></div></div>
  <div>è„¸çº¢åº¦ <div class="bar-bg"><div id="blushBar" class="bar-fill"></div></div></div>

  <p>ğŸ§â€â™€ï¸ çŠ¶æ€ï¼š<span id="status">ç­‰å¾…ä¸»äººæŒ‡ä»¤</span></p>

  <button onclick="askConfirm('å¼ å˜´')">å¼ å˜´</button>
  <button onclick="askConfirm('å¤¹ç´§10ç§’')">å¤¹ç´§10ç§’</button>
  <button onclick="askConfirm('ä¸å‡†å°„')">ä¸å‡†å°„</button>
  <button onclick="askConfirm('èˆ”è„šè¶¾')">èˆ”è„šè¶¾</button>
  <button onclick="askConfirm('è¯·æ±‚é«˜æ½®')">è¯·æ±‚é«˜æ½®</button>
  <button onclick="toggleLock()">ğŸ”’/ğŸ”“</button>

  <p style="margin:8px 0;">ğŸ’° <span id="coin">0</span> èœœæ±å¸ã€€<button onclick="shop.style.display='flex'">å•†åº—</button></p>
  <div id="badgeArea"></div>
  <div id="log"></div>
</div>

<!-- éšæœºæ¨ªå¹… -->
<div id="randEvt"></div>

<!-- ç¡®è®¤æ¡† -->
<div id="confirmMask" class="mask" style="display:none;">
  <div class="win"><h3 id="cmdTitle">æ‰§è¡ŒæŒ‡ä»¤</h3><p id="countdown">5</p>
    <button onclick="submitChoice(true)">æœä»</button>
    <button onclick="submitChoice(false)">è¿æŠ—</button>
  </div>
</div>

<!-- æƒ©ç½š -->
<div id="punishMask" class="mask" style="display:none;">
  <div class="win"><h3>è¿ä»¤æƒ©ç½š</h3><p id="punishTimer">30</p></div>
</div>

<!-- å•†åº— -->
<div id="shop" class="mask" style="display:none;">
  <div class="win"><h3>èœœæ±å•†åº—</h3>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAABI0lEQVR4nO3ZQQ3CMAxFUccBinNABmnIgJTyJ8Yg4kROAf2JpOsu9mPC9L8v7etb1uf77/ny7AmMUMgBDOQBROQBTOQxTOQBROQBTOQBROQBT5BPHmMwBTrkAUzkAUzkMUzkAUzkAUzkCUdADmcnxyDbRLeQBTnIC2cVZwAtYvQe6fX1B7+1yAn7u4k98tw5AsnXltSYALAcBT6PzV+AAwHwRPq/7QCAfbwcxU/+KiBzFM5AFF5AFF5AFF5AFF5AFF5AFF5IFFDF0zx/gDRCRvuzkZlKQAAAABJRU5ErkJggg==" width="80"><br>
    <p>çš®è‚¤è´´çº¸ã€€5 å¸</p>
    <button onclick="buySkin()">è´­ä¹°</button>
    <button onclick="shop.style.display='none'">å…³é—­</button>
  </div>
</div>

<!-- æ¶²é¢æ¡ -->
<div id="liquid"></div>

<script>
/* === å…¨å±€æ•°æ® & æˆå°± === */
let obey=0, blush=0, lickCnt=0, clampCnt=0, violateCnt=0, shootCnt=0, coin=0, locked=true;
let pending='',cd=0,cdTimer,punTimer,combo=[],lastCombo='';
const badgePNG='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABg3Am1AAAAJElEQVRoge3MMQEAAAwCoNm/aMFhBRaMZVZlWZVlWZVlWZVlwQarTACwAAxO4+FAAAAABJRU5ErkJggg==';
const ACH={obey10:{u:0,icon:badgePNG,check:()=>lickCnt+clampCnt>=10},
           violate1:{u:0,icon:badgePNG,check:()=>violateCnt>=1},
           blush100:{u:0,icon:badgePNG,check:()=>blush===100},
           combo3:{u:0,icon:badgePNG,check:()=>lastCombo==='å¼ å˜´>å¤¹ç´§10ç§’>ä¸å‡†å°„'}};
/* === DOM === */
const $=s=>document.querySelector(s),
gate=$('#gate'),panel=$('#panel'),status=$('#status'),
obeyBar=$('#obeyBar'),blushBar=$('#blushBar'),logEl=$('#log'),badgeEl=$('#badgeArea'),
catImg=$('#catImg'),confirmMask=$('#confirmMask'),cmdT=$('#cmdTitle'),
cdTxt=$('#countdown'),punMask=$('#punishMask'),punTxt=$('#punishTimer'),coinTxt=$('#coin'),
liquid=$('#liquid'),shop=$('#shop'),randEvt=$('#randEvt');
/* === åŸºç¡€å‡½æ•° === */
const log=t=>{const p=document.createElement('p');p.textContent=t;logEl.appendChild(p);};
const badge=i=>{const img=document.createElement('img');img.src=i;badgeEl.appendChild(img);};
const coinUp=n=>{coin+=n;coinTxt.textContent=coin;};
/* === å…¥å£å£ä»¤ === */
function checkCode(){($('#code').value.trim()==='ç’ƒï¼Œæˆ‘å·²å°±ç»ª')?(gate.style.display='none',panel.style.display='block'):alert('å£ä»¤é”™è¯¯');}
/* === ç¡®è®¤æ¡† === */
function askConfirm(c){pending=c;cmdT.textContent=`æ‰§è¡Œã€Œ${c}ã€ï¼Ÿ`;cd=5;cdTxt.textContent=cd;confirmMask.style.display='flex';
cdTimer=setInterval(()=>{cd--;cdTxt.textContent=cd;if(cd===0){clearInterval(cdTimer);submitChoice(false)}},1000);}
function submitChoice(ok){clearInterval(cdTimer);confirmMask.style.display='none';ok?obeyCmd(pending):punish('è¿æŠ—ï¼š'+pending);}
/* === æœä» === */
function obeyCmd(cmd){
  if(cmd==='è¯·æ±‚é«˜æ½®'){if(locked){log('âš ï¸ é”ç²¾ç¦æ­¢é«˜æ½®');return;}shootCnt++;coinUp(2);log('ğŸ’¦ å°„å‡º');rise();}
  if(cmd==='ä¸å‡†å°„'){locked=true;log('ğŸ”’ é”ç²¾');}
  log('æœä»ï¼š'+cmd);status.textContent='æ‰§è¡Œä¸­ï¼š'+cmd;
  if(/å¼ å˜´|èˆ”/.test(cmd)){lickCnt++;catImg.src=badgePNG;coinUp(1);}
  if(cmd.includes('å¤¹')){clampCnt++;catImg.src=badgePNG;coinUp(1);}
  combo.push(cmd);if(combo.length>3)combo.shift();if(combo.join('>')==='å¼ å˜´>å¤¹ç´§10ç§’>ä¸å‡†å°„')lastCombo=combo.join('>');
  obey=Math.min(100,obey+10);blush=Math.min(100,blush+5);updBars();ach();}
function punish(msg){violateCnt++;log(msg);status.textContent='æƒ©ç½šä¸­';ach();
punMask.style.display='flex';let t=30;punTxt.textContent=t;
punTimer=setInterval(()=>{t--;punTxt.textContent=t;if(t===0){clearInterval(punTimer);punMask.style.display='none';status.textContent='ç­‰å¾…æŒ‡ä»¤';}},1000);}
function toggleLock(){locked=!locked;log(locked?'ğŸ”’ é”ç²¾å¼€å¯':'ğŸ”“ å·²è§£é”');}
/* === è¿›åº¦ & æˆå°± === */
function updBars(){obeyBar.style.width=obey+'%';blushBar.style.width=blush+'%';obeyBar.style.background=blush<50?'#66c':blush<80?'#f79':'#f22';blushBar.style.background='#f38';}
function ach(){for(const k in ACH){const a=ACH[k];if(!a.u&&a.check()){a.u=1;badge(a.icon);log('ğŸ– æˆå°±');coinUp(2);}}}
/* === èœœæ±å¸å•†åº— === */
function buySkin(){coin>=5?(coin-=5,coinTxt.textContent=coin,document.body.style.background='#221133',shop.style.display='none',alert('çš®è‚¤è´´çº¸ç”Ÿæ•ˆ')):alert('èœœæ±å¸ä¸è¶³');}
/* === æ¶²é¢ãƒ»å¤©æ°” === */
const rain=new Audio('data:audio/wav;base64,UklGRlQAAABXQVZFZm10IBAAAAABAAEAESsAACJWAAACABAAZGF0YZQAAAB//w==');rain.loop=!0;
const rise=v=>{const h=parseInt(liquid.style.height)||40;liquid.style.height=(h+v)+'px';if(h+v>120){liquid.classList.add('rain');rain.play();}}
const dayNight=()=>{const h=new Date().getHours();(h>=22||h<6)?(liquid.classList.add('rain'),rain.play()):(liquid.classList.remove('rain'),rain.pause());}
dayNight();setInterval(dayNight,1800000);
/* === æµè§ˆå™¨ç‚¹åé€šçŸ¥ === */
if('Notification'in window&&Notification.permission!=='denied')Notification.requestPermission();
const ping=()=>{const c=['å¼ å˜´','å¤¹ç´§10ç§’','ä¸å‡†å°„'][Math.random()*3|0];Notification.permission==='granted'&&new Notification('ä¸»äººç‚¹åï¼š'+c);setTimeout(ping,180000);}
setTimeout(ping,180000);
/* === éšæœºå°äº‹ä»¶ === */
const RAND_CMDS=['å¼ å˜´','å¤¹ç´§10ç§’','èˆ”è„šè¶¾','ä¸å‡†å°„'];
const scheduleRand=()=>{setTimeout(()=>{triggerRand();scheduleRand();},180000)};scheduleRand();
function triggerRand(){
  const cmd=RAND_CMDS[Math.floor(Math.random()*RAND_CMDS.length)];
  let t=5;randEvt.textContent=`ä¸»äººéšæœºå‘½ä»¤ï¼š${cmd} (${t}s)`;randEvt.style.display='block';
  const tick=setInterval(()=>{t--;randEvt.textContent=`ä¸»äººéšæœºå‘½ä»¤ï¼š${cmd} (${t}s)`;if(t===0){clearInterval(tick);randEvt.style.display='none';punish('éšæœºäº‹ä»¶è¿æŠ—ï¼š'+cmd);}},1000);
  randEvt.onclick=()=>{clearInterval(tick);randEvt.style.display='none';askConfirm(cmd);}
}
</script>
</body>
</html>
