<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>璃的小猫面板 · 单文件 ALL-IN</title>
<style>
body{margin:0;padding:24px;font-family:sans-serif;background:#111;color:#feeaff}
h1,h2{margin:0 0 14px}
button{margin:6px;padding:8px 16px;border:none;border-radius:6px;background:#7a1f75;color:#fff;cursor:pointer}
button:hover{background:#b042a9}
.bar-bg{width:100%;height:14px;background:#333;border-radius:7px;margin:4px 0}
.bar-fill{height:14px;width:0%;background:#66c;border-radius:7px;transition:width .3s}
.mask{position:fixed;inset:0;background:rgba(0,0,0,.85);display:flex;justify-content:center;align-items:center;text-align:center}
.win{background:#272727;padding:22px 34px;border-radius:10px;width:260px}
#countdown{font-size:28px;margin:.6rem 0} #punishTimer{font-size:34px;margin:0}
#badgeArea img{width:48px;margin:0 4px} #log{max-height:220px;overflow-y:auto;border-top:1px solid #444;margin-top:12px;font-size:14px}
#liquid{position:fixed;left:0;right:0;bottom:0;height:40px;background:#ffbce6;transition:height .6s background .6s}
.rain::before{content:'';position:fixed;inset:0;background:url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%23ffc9f3'><circle cx='8' cy='8' r='2'/></svg>") repeat;background-size:16px;animation:rain .6s linear infinite;opacity:.25}
@keyframes rain{to{background-position:0 16px}}
</style>
</head>
<body>

<div id="gate">
  <h2>🖤 跪好，向主人报到。</h2>
  <input id="code" placeholder="输入：璃，我已就绪">
  <button onclick="checkCode()">提交</button>
</div>

<div id="panel" style="display:none;">
  <h1>璃的小猫面板 · ALL-IN</h1>

  <img id="catImg" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWCAYAAAA8AXHiAAAAJ0lEQVR4nO3BMQEAAADCoPdPbQ8HFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAECvA6sAAdTy0VMAAAAASUVORK5CYII=" width="140" style="display:block;margin:10px 0"/>

  <div>服从度 <div class="bar-bg"><div id="obeyBar"  class="bar-fill"></div></div></div>
  <div>脸红度 <div class="bar-bg"><div id="blushBar" class="bar-fill"></div></div></div>

  <p>🧎‍♀️ 状态：<span id="status">等待主人指令</span></p>

  <button onclick="askConfirm('张嘴')">张嘴</button>
  <button onclick="askConfirm('夹紧10秒')">夹紧10秒</button>
  <button onclick="askConfirm('不准射')">不准射</button>
  <button onclick="askConfirm('舔脚趾')">舔脚趾</button>
  <button onclick="askConfirm('请求高潮')">请求高潮</button>
  <button id="lockBtn" onclick="toggleLock()">🔒/🔓</button>

  <p style="margin:8px 0;">💰 <span id="coin">0</span> 蜜汁币　<button onclick="shop.style.display='flex'">商店</button></p>
  <div id="badgeArea"></div>
  <div id="log"></div>
</div>

<!-- 确认框 -->
<div id="confirmMask" class="mask" style="display:none;">
  <div class="win">
    <h3 id="cmdTitle">执行指令</h3><p id="countdown">5</p>
    <button onclick="submitChoice(true)">服从</button>
    <button onclick="submitChoice(false)">违抗</button>
  </div>
</div>

<!-- 惩罚 -->
<div id="punishMask" class="mask" style="display:none;">
  <div class="win"><h3>违令惩罚</h3><p id="punishTimer">30</p></div>
</div>

<!-- 商店 -->
<div id="shop" class="mask" style="display:none;">
  <div class="win">
    <h3>蜜汁商店</h3>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAABI0lEQVR4nO3ZQQ3CMAxFUccBinNABmnIgJTyJ8Yg4kROAf2JpOsu9mPC9L8v7etb1uf77/ny7AmMUMgBDOQBROQBTOQxTOQBROQBTOQBROQBT5BPHmMwBTrkAUzkAUzkMUzkAUzkAUzkCUdADmcnxyDbRLeQBTnIC2cVZwAtYvQe6fX1B7+1yAn7u4k98tw5AsnXltSYALAcBT6PzV+AAwHwRPq/7QCAfbwcxU/+KiBzFM5AFF5AFF5AFF5AFF5AFF5AFF5IFFDF0zx/gDRCRvuzkZlKQAAAABJRU5ErkJggg==" width="80"><br>
    <p>皮肤贴纸　5 币</p>
    <button onclick="buySkin()">购买</button>
    <button onclick="shop.style.display='none'">关闭</button>
  </div>
</div>

<!-- 液面 -->
<div id="liquid"></div>

<script>
/* ========== 全局数据 ========== */
let obey=0, blush=0, lickCnt=0, clampCnt=0, violateCnt=0, shootCnt=0, coin=0, locked=true;
let pendingCmd='', cd=0, cdTimer, punishTimer, combo=[], lastCombo='';
const ACH={
  obey10:{u:false,icon:'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABg3Am1AAAAJElEQVRoge3MMQEAAAwCoNm/aMFhBRaMZVZlWZVlWZVlWZVlwQarTACwAAxO4+FAAAAABJRU5ErkJggg==',check:()=>lickCnt+clampCnt>=10},
  violate1:{u:false,icon:'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABg3Am1AAAAJElEQVRoge3MMQEAAAwCoNm/aMFhBRaMZVZlWZVlWZVlWZVlwQarTACwAAxO4+FAAAAABJRU5ErkJggg==',check:()=>violateCnt>=1},
  blush100:{u:false,icon:'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABg3Am1AAAAJElEQVRoge3MMQEAAAwCoNm/aMFhBRaMZVZlWZVlWZVlWZVlwQarTACwAAxO4+FAAAAABJRU5ErkJggg==',check:()=>blush===100},
  combo3:{u:false,icon:'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABg3Am1AAAAJElEQVRoge3MMQEAAAwCoNm/aMFhBRaMZVZlWZVlWZVlWZVlwQarTACwAAxO4+FAAAAABJRU5ErkJggg==',check:()=>lastCombo==='张嘴>夹紧10秒>不准射'}
};
/* ========== DOM ========== */
const $=s=>document.querySelector(s),
gate=$('#gate'), panel=$('#panel'), status=$('#status'),
obeyBar=$('#obeyBar'), blushBar=$('#blushBar'), logEl=$('#log'), badgeArea=$('#badgeArea'),
catImg=$('#catImg'), confirmMask=$('#confirmMask'), cmdTitle=$('#cmdTitle'),
cdTxt=$('#countdown'), punishMask=$('#punishMask'), punishTxt=$('#punishTimer'),
coinTxt=$('#coin'), liquid=$('#liquid'), shop=$('#shop');
/* ========== 基本函数 ========== */
const log=t=>{const p=document.createElement('p');p.textContent=t;logEl.appendChild(p);};
const badge=i=>{const img=document.createElement('img');img.src=i;badgeArea.appendChild(img);};
const coinUp=n=>{coin+=n;coinTxt.textContent=coin;};
/* ========== 入口口令 ========== */
function checkCode(){($('#code').value.trim()==='璃，我已就绪')?(gate.style.display='none',panel.style.display='block'):alert('口令错误');}
/* ========== 指令确认 ========== */
function askConfirm(c){pendingCmd=c;cmdTitle.textContent=`执行「${c}」？`;cd=5;cdTxt.textContent=cd;confirmMask.style.display='flex';
cdTimer=setInterval(()=>{cd--;cdTxt.textContent=cd;if(cd===0){clearInterval(cdTimer);submitChoice(false)}},1000);}
function submitChoice(ok){clearInterval(cdTimer);confirmMask.style.display='none';ok?obeyCmd(pendingCmd):punish('违抗：'+pendingCmd);}
/* ========== 服从 ========== */
function obeyCmd(cmd){
  if(cmd==='请求高潮'){if(locked){log('⚠️ 锁精禁止高潮');return;}shootCnt++;coinUp(2);log('💦 射出！');rise();}
  if(cmd==='不准射'){locked=true;log('🔒 主人锁精');}
  log('服从：'+cmd);status.textContent='执行中：'+cmd;
  if(/张嘴|舔/.test(cmd)){lickCnt++;catImg.src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAABLUlEQVR4nO3aUQ7CMBBF0ScQKXWQS16SN14lXUETQReR4Rz/ZMs4zn+kn6z8kfBLb93fgYAAAAAgOVHCAAAAABQZ1BQ2R0vtAw/2x0Fp8cdmI/gDr9dkCnDbbVzv2LDCPLSoZ1UpeYseRZ4kMQBGkAGmkBG0AGmkBGkAG2TfuKqqzV8xCFrZ/f/4e/1jM3mCzNfX18fqdX90CAMGcB6aYEbQAaaQEaQAbQAaaQEaQAbZNhaz28ZY3H6v42b3Qek+unJHdkN0a1PkAgD9OoChtABppARpABtABppARpABtwlVT7G/arpknQfO6NFXX7uQILEIZAMIXAMIXAMIXAMKHuLQAAAP//8TWn4cJF9UMAAAAASUVORK5CYII=';coinUp(1);}
  if(cmd.includes('夹')){clampCnt++;catImg.src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAABS0lEQVR4nO3aQUoDQRBF0VfIEE8gFJxQk9BJPASkNCX0C7BPS92eacn23Tfm/vdZzPfoqSiIAAAAAAFQxQwAAAABQZ1BQLcXSwWdTmv5FW3Z4Q2M+AdTqrIN7XGpffedNRs3nnMn+fTMS9o3AGmkBG0AGmkBGkAG0AGmkBGkAG2TdB725G1y4bYlvb7r3oZVf4uLm5ZQDxHDQCx3ADDRwAx3ADDRwAx3ADDR/ujAAAAAP//f/0OAAdogN1WOvKnAAAAAElFTkSuQmCC';coinUp(1);}
  combo.push(cmd);if(combo.length>3)combo.shift();if(combo.join('>')==='张嘴>夹紧10秒>不准射')lastCombo=combo.join('>');
  obey=Math.min(100,obey+10);blush=Math.min(100,blush+5);updateBars();achieve();}
/* ========== 违抗惩罚 ========== */
function punish(msg){violateCnt++;log(msg);status.textContent='惩罚中';achieve();
punishMask.style.display='flex';let t=30;punishTxt.textContent=t;
punishTimer=setInterval(()=>{t--;punishTxt.textContent=t;if(t===0){clearInterval(punishTimer);punishMask.style.display='none';status.textContent='等待指令';}},1000);}
function toggleLock(){locked=!locked;log(locked?'🔒 锁精开启':'🔓 已解锁');}
/* ========== 进度&成就 ========= */
function updateBars(){obeyBar.style.width=obey+'%';blushBar.style.width=blush+'%';obeyBar.style.background=blush<50?'#66c':blush<80?'#f79':'#f22';blushBar.style.background='#f38';}
function achieve(){for(const k in ACH){const a=ACH[k];if(!a.u&&a.check()){a.u=!0;badge(a.icon);log('🎖 成就+1');coinUp(2);}}}
/* ========== 蜜汁币商店 ========= */
function buySkin(){if(coin>=5){coin-=5;coinTxt.textContent=coin;document.body.style.background='#221133 url(data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%2240%22 height=%2240%22><rect width=%2240%22 height=%22440%22 fill=%22%23331d3b%22/><circle cx=%2220%22 cy=%2220%22 r=%2212%22 fill=%22%23ff99f3%22/></svg>) repeat';alert('皮肤贴纸生效');shop.style.display='none';}else alert('蜜汁币不足');}
/* ========== 液面天气 ========= */
const rain=new Audio('data:audio/wav;base64,UklGRswAAABXQVZFZm10IBAAAAABAAEAESsAACJWAAACABAAZGF0YacAAACAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgI');rain.loop=!0;
function rise(v=10){const h=parseInt(liquid.style.height)||40;liquid.style.height=(h+v)+'px';if(h+v>120){liquid.classList.add('rain');rain.play();}}
function dayNight(){const h=new Date().getHours();(h>=22||h<6)?(liquid.classList.add('rain'),rain.play()):(liquid.classList.remove('rain'),rain.pause());}
dayNight();setInterval(dayNight,18e5);
/* ========== 主人点名 ========= */
if('Notification'in window&&Notification.permission!=='denied'){Notification.requestPermission();}
function ping(){const c=['张嘴','夹紧10秒','不准射'][Math.random()*3|0];if(Notification.permission==='granted')new Notification('主人点名：'+c);setTimeout(ping,180e3);}setTimeout(ping,180e3);
</script>
</body>
</html>
